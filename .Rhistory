title, publication_date, journal_title, citation_count) %>%
mutate(top5 = as.numeric(journal_title %in% Top5_journals),
topother = as.numeric(journal_title %in% TopOther_journals)) %>%
group_by(author_name, publication_date) %>%
summarise(top5_count = sum(top5),
topother_count = sum(topother)) %>%
filter(top5_count + topother_count > 0) %>%
right_join(Author_cumulative_citations.data) %>%
replace_na(list(top5_count = 0, topother_count = 0))
# Top5_since
Top5_since.data <- Author_cumulative_citations.data %>%
mutate(top5 = as.numeric(top5_count > 0)) %>%
arrange(author_name, publication_date) %>%
group_by(author_name) %>% filter(max(top5) > 0) %>%
mutate(since_first_top5 = publication_date - min(((top5!=1)+1) * publication_date)) %>%
select(author_name, publication_date, top5, since_first_top5, total_citations) %>%
arrange(author_name, since_first_top5)
# Top other since
Topother_since.data <- Author_cumulative_citations.data %>%
mutate(topother = as.numeric(topother_count > 0)) %>%
group_by(author_name) %>% filter(max(topother) > 0) %>%
mutate(since_first_topother = publication_date - min(((topother!=1)+1) * publication_date)) %>%
select(author_name, publication_date, topother, since_first_topother, total_citations, cum_citations)
# Draw event study style graph
Top5_since.data %>%
lm(mean_citations ~ as.factor(since_first_top5), data = .)
# Draw event study style graph
Top5_since.data %>%
lm(total_citations ~ as.factor(since_first_top5), data = .)
# Draw event study style graph
Top5_since.data %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .)
# Draw event study style graph
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .)
# Draw event study style graph
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(total_citations ~ as.factor(since_first_top5), data = .)
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(total_citations ~ as.factor(since_first_top5), data = .) %>%
broom::tidy()
# Draw event study style graph
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy()
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy()
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1)
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>% mutate(term = coefficient_range)
coefficient_range <- c(min(Top5_since.data$since_first_topother),
max(Top5_since.data$since_first_topother))
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>% mutate(term = coefficient_range)
coefficient_range <- c(min(Top5_since.data$since_first_topother):
max(Top5_since.data$since_first_topother))
min(Top5_since.data$since_first_topother):
max(Top5_since.data$since_first_topother)
min(Top5_since.data$since_first_top5)
c(min(Top5_since.data$since_first_top5):
max(Top5_since.data$since_first_top5))
coefficient_range <- c(min(Top5_since.data$since_first_top5):
max(Top5_since.data$since_first_top5))
coefficient_range <- c(min(Top5_since.data$since_first_top5):
max(Top5_since.data$since_first_top5))
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>% mutate(term = coefficient_range)
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1)
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>% mutate(term = coefficient_range) %>% pull(term)
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>% pull(term)
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>% pull(term) %>% str_extract('[^)]+$')
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>% pull(term) %>% str_extract('[^)]+$') %>% as.numeric()
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$')))
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>% View()
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>%
ggplot(aes(x = coefficient)) +
geom_point(aes(y = estimate))
# Conventional top journals
Top5_journals <- c('American Economic Review',
'Journal of Political Economy',
'The Quarterly Journal of Economics',
'Econometrica',
'Review of Economic Studies')
# Comparable next 6.
TopOther_journals <- Journals_articles.data %>% head(10) %>%
pull(journal_title) %>% setdiff(Top5_journals)
# Find date of a top 5 and Top other journal for each author
Author_cumulative_citations.data <- Economists_articles.links %>%
left_join(select(Economists.data, url, name,
institution, affiliation, degree,) %>%
rename(author_name = name, author_url = url), by = 'author_url') %>%
left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
select(author_name, institution, affiliation, degree,
title, publication_date, journal_title, citation_count) %>%
mutate(top5 = as.numeric(journal_title %in% Top5_journals),
topother = as.numeric(journal_title %in% TopOther_journals)) %>%
group_by(author_name, publication_date) %>%
summarise(top5_count = sum(top5),
topother_count = sum(topother)) %>%
filter(top5_count + topother_count > 0) %>%
right_join(Author_cumulative_citations.data) %>%
replace_na(list(top5_count = 0, topother_count = 0))
# Top5_since
Top5_since.data <- Author_cumulative_citations.data %>%
mutate(top5 = as.numeric(top5_count > 0)) %>%
arrange(author_name, publication_date) %>%
group_by(author_name) %>% filter(max(top5) > 0) %>%
mutate(since_first_top5 = publication_date - min(((top5!=1)+1) * publication_date)) %>%
select(author_name, publication_date, top5, since_first_top5, total_citations) %>%
arrange(author_name, since_first_top5)
# Top other since
Topother_since.data <- Author_cumulative_citations.data %>%
mutate(topother = as.numeric(topother_count > 0)) %>%
group_by(author_name) %>% filter(max(topother) > 0) %>%
mutate(since_first_topother = publication_date - min(((topother!=1)+1) * publication_date)) %>%
select(author_name, publication_date, topother, since_first_topother, total_citations, cum_citations)
# Draw event study style graph, for the top5
coefficient_range <- c(min(Top5_since.data$since_first_top5):
max(Top5_since.data$since_first_top5))
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>%
ggplot(aes(x = coefficient, y = estimate)) + geom_point() +
ggtitle('Log Citations by year to author first top5 publication')
# Draw event study style graph, for the top other
coefficient_range <- c(min(Topother_since.data$since_first_topother):
max(Topother_since.data$since_first_topother))
Topother_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_topother), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>%
ggplot(aes(x = coefficient, y = estimate)) + geom_point() +
ggtitle('Log Citations by year to author first top other publication')
View(Top5_since.data)
Topother_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_topother), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$')))
Topother_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_topother), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>% View()
# Conventional top journals
Top5_journals <- c('American Economic Review',
'Journal of Political Economy',
'The Quarterly Journal of Economics',
'Econometrica',
'Review of Economic Studies')
# Comparable next 6.
TopOther_journals <- Journals_articles.data %>% head(10) %>%
pull(journal_title) %>% setdiff(Top5_journals)
# Find date of a top 5 and Top other journal for each author
Author_cumulative_citations.data <- Economists_articles.links %>%
left_join(select(Economists.data, url, name,
institution, affiliation, degree,) %>%
rename(author_name = name, author_url = url), by = 'author_url') %>%
left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
select(author_name, institution, affiliation, degree,
title, publication_date, journal_title, citation_count) %>%
mutate(top5 = as.numeric(journal_title %in% Top5_journals),
topother = as.numeric(journal_title %in% TopOther_journals)) %>%
group_by(author_name, publication_date) %>%
summarise(top5_count = sum(top5),
topother_count = sum(topother)) %>%
filter(top5_count + topother_count > 0) %>%
right_join(Author_cumulative_citations.data) %>%
replace_na(list(top5_count = 0, topother_count = 0))
# Top5_since
Top5_since.data <- Author_cumulative_citations.data %>%
mutate(top5 = as.numeric(top5_count > 0)) %>%
arrange(author_name, publication_date) %>%
group_by(author_name) %>% filter(max(top5) > 0) %>%
mutate(since_first_top5 = publication_date - min(((top5!=1)+1) * publication_date)) %>%
select(author_name, publication_date, top5, since_first_top5, total_citations) %>%
arrange(author_name, since_first_top5)
# Top other since
Topother_since.data <- Author_cumulative_citations.data %>%
mutate(topother = as.numeric(topother_count > 0)) %>%
group_by(author_name) %>% filter(max(topother) > 0) %>%
mutate(since_first_topother = publication_date - min(((topother!=1)+1) * publication_date)) %>%
select(author_name, publication_date, topother, since_first_topother, total_citations, cum_citations)
# Draw event study style graph, for the top5
coefficient_range <- c(min(Top5_since.data$since_first_top5):
max(Top5_since.data$since_first_top5))
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>%
filter(p.value < 0.5) %>%
ggplot(aes(x = coefficient, y = estimate)) + geom_point() +
ggtitle('Log Citations by year to author first top5 publication')
# Draw event study style graph, for the top other
coefficient_range <- c(min(Topother_since.data$since_first_topother):
max(Topother_since.data$since_first_topother))
Topother_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_topother), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>%
filter(p.value < 0.5) %>%
ggplot(aes(x = coefficient, y = estimate)) + geom_point() +
ggtitle('Log Citations by year to author first top other publication')
# Conventional top journals
Top5_journals <- c('American Economic Review',
'Journal of Political Economy',
'The Quarterly Journal of Economics',
'Econometrica',
'Review of Economic Studies')
# Comparable next 6.
TopOther_journals <- Journals_articles.data %>% head(10) %>%
pull(journal_title) %>% setdiff(Top5_journals)
# Find date of a top 5 and Top other journal for each author
Author_cumulative_citations.data <- Economists_articles.links %>%
left_join(select(Economists.data, url, name,
institution, affiliation, degree,) %>%
rename(author_name = name, author_url = url), by = 'author_url') %>%
left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
select(author_name, institution, affiliation, degree,
title, publication_date, journal_title, citation_count) %>%
mutate(top5 = as.numeric(journal_title %in% Top5_journals),
topother = as.numeric(journal_title %in% TopOther_journals)) %>%
group_by(author_name, publication_date) %>%
summarise(top5_count = sum(top5),
topother_count = sum(topother)) %>%
filter(top5_count + topother_count > 0) %>%
right_join(Author_cumulative_citations.data) %>%
replace_na(list(top5_count = 0, topother_count = 0))
# Top5_since
Top5_since.data <- Author_cumulative_citations.data %>%
mutate(top5 = as.numeric(top5_count > 0)) %>%
arrange(author_name, publication_date) %>%
group_by(author_name) %>% filter(max(top5) > 0) %>%
mutate(since_first_top5 = publication_date - min(((top5!=1)+1) * publication_date)) %>%
select(author_name, publication_date, top5, since_first_top5, total_citations) %>%
arrange(author_name, since_first_top5)
# Top other since
Topother_since.data <- Author_cumulative_citations.data %>%
mutate(topother = as.numeric(topother_count > 0)) %>%
group_by(author_name) %>% filter(max(topother) > 0) %>%
mutate(since_first_topother = publication_date - min(((topother!=1)+1) * publication_date)) %>%
select(author_name, publication_date, topother, since_first_topother, total_citations, cum_citations)
# Draw event study style graph, for the top5
coefficient_range <- c(min(Top5_since.data$since_first_top5):
max(Top5_since.data$since_first_top5))
Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>%
filter(abs(coefficient) < 21) %>%
ggplot(aes(x = coefficient, y = estimate)) + geom_point() +
ggtitle('Log Citations by year to author first top5 publication')
# Draw event study style graph, for the top other
coefficient_range <- c(min(Topother_since.data$since_first_topother):
max(Topother_since.data$since_first_topother))
Topother_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_topother), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>%
filter(abs(coefficient) < 21) %>%
ggplot(aes(x = coefficient, y = estimate)) + geom_point() +
ggtitle('Log Citations by year to author first top other publication')
grid.arrange(Top5.eventstudy, Topother.eventstudy, nrow = 1)
# Conventional top journals
Top5_journals <- c('American Economic Review',
'Journal of Political Economy',
'The Quarterly Journal of Economics',
'Econometrica',
'Review of Economic Studies')
# Comparable next 6.
TopOther_journals <- Journals_articles.data %>% head(10) %>%
pull(journal_title) %>% setdiff(Top5_journals)
# Find date of a top 5 and Top other journal for each author
Author_cumulative_citations.data <- Economists_articles.links %>%
left_join(select(Economists.data, url, name,
institution, affiliation, degree,) %>%
rename(author_name = name, author_url = url), by = 'author_url') %>%
left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
select(author_name, institution, affiliation, degree,
title, publication_date, journal_title, citation_count) %>%
mutate(top5 = as.numeric(journal_title %in% Top5_journals),
topother = as.numeric(journal_title %in% TopOther_journals)) %>%
group_by(author_name, publication_date) %>%
summarise(top5_count = sum(top5),
topother_count = sum(topother)) %>%
filter(top5_count + topother_count > 0) %>%
right_join(Author_cumulative_citations.data) %>%
replace_na(list(top5_count = 0, topother_count = 0))
# Top5_since
Top5_since.data <- Author_cumulative_citations.data %>%
mutate(top5 = as.numeric(top5_count > 0)) %>%
arrange(author_name, publication_date) %>%
group_by(author_name) %>% filter(max(top5) > 0) %>%
mutate(since_first_top5 = publication_date - min(((top5!=1)+1) * publication_date)) %>%
select(author_name, publication_date, top5, since_first_top5, total_citations) %>%
arrange(author_name, since_first_top5)
# Top other since
Topother_since.data <- Author_cumulative_citations.data %>%
mutate(topother = as.numeric(topother_count > 0)) %>%
group_by(author_name) %>% filter(max(topother) > 0) %>%
mutate(since_first_topother = publication_date - min(((topother!=1)+1) * publication_date)) %>%
select(author_name, publication_date, topother, since_first_topother, total_citations, cum_citations)
# Draw event study style graph, for the top5
coefficient_range <- c(min(Top5_since.data$since_first_top5):
max(Top5_since.data$since_first_top5))
Top5.eventstudy <- Top5_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_top5), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>%
filter(abs(coefficient) < 21) %>%
ggplot(aes(x = coefficient, y = estimate)) + geom_point() +
ggtitle('Log Citations by year to author first top5 publication')
# Draw event study style graph, for the top other
coefficient_range <- c(min(Topother_since.data$since_first_topother):
max(Topother_since.data$since_first_topother))
Topother.eventstudy <- Topother_since.data %>%
filter(total_citations > 0) %>%
lm(log(total_citations) ~ as.factor(since_first_topother), data = .) %>%
broom::tidy() %>% slice(-1) %>%
mutate(coefficient = as.numeric(str_extract(term, '[^)]+$'))) %>%
filter(abs(coefficient) < 21) %>%
ggplot(aes(x = coefficient, y = estimate)) + geom_point() +
ggtitle('Log Citations by year to author first top other publication')
grid.arrange(Top5.eventstudy, Topother.eventstudy, nrow = 1)
ggplot2::grid.arrange(Top5.eventstudy, Topother.eventstudy, nrow = 1)
gridExtra::grid.arrange(Top5.eventstudy, Topother.eventstudy, nrow = 1)
rm(list = ls())
gc()
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, cache = F, fig.align = 'center')
library(tidyverse)
library(data.table)
library(tidytext)
# Load the data on Economists
Economists.data <- fread('../Data/RePEc_data/Economists_data/Economists_repec_data.csv')
# Load the data on published articles
Articles.data <- fread('../Data/RePEc_data/Papers_data/Journal_articles_repec.csv')
# Load Economist-article individual links -- made externally in Python
Economists_articles.links <- fread('../Data/RePEc_data/Economists_data/Economists_articles_repec.csv')
# Load info on journal rankings
Journals.data <- fread('../Data/RePEc_data/Journals_data/Journal_info_repec.csv')
# The most prolific authors, within these data
## WHo have the most citations, in these data
Economists_citations.data <- Economists_articles.links %>%
left_join(select(Economists.data, url, name,
institution, affiliation, degree,) %>%
rename(author_name = name, author_url = url), by = 'author_url') %>%
left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
select(author_name, institution, affiliation, degree,
title, publication_date, journal_title, citation_count) %>%
filter(!is.na(citation_count)) %>%
group_by(author_name) %>%
summarise(total_citations = sum(citation_count, na.rm = T),
mean_citations = round(mean(citation_count, na.rm = T)),
total_articles = n()) %>%
arrange(-total_citations)
# SHow the top ten
Economists_citations.data %>% head(10) %>%
knitr::kable(format = 'markdown')
# Gini coefficient for article citations.
Articles.data %>%
filter(!is.na(citation_count)) %>%
pull(citation_count) %>% reldist::gini()
# Gini coefficient for article citations.
Articles.data %>%
filter(!is.na(citation_count)) %>%
ggplot(aes(x = citation_count)) +
geom_histogram(binwidth = 1)
# Per year summarise
Citation_count.data <- Articles.data %>%
filter(!is.na(citation_count) & !is.na(publication_date)) %>%
group_by(publication_date) %>%
summarise(total_citations = sum(citation_count, na.rm = T),
mean_citations = round(mean(citation_count, na.rm = T)),
total_articles = n(),
gini_coefficient = reldist::gini(citation_count))
# Gini coefficient for article citations.
Citation_count.data %>%
filter(total_articles	> 100) %>%
ggplot(aes(x = publication_date, y = gini_coefficient)) +
geom_line() +
scale_x_continuous(name = 'Year Published', breaks = seq(1975, 2020, by = 5)) +
scale_y_continuous(name = 'Citations Gini Index (among articles)',
breaks = seq(0, 0.5, by = 0.1), limits = c(0,0.5))
# Gini coefficient for authors.
Economists_articles.links %>%
left_join(select(Economists.data, url, name,
institution, affiliation, degree,) %>%
rename(author_name = name, author_url = url), by = 'author_url') %>%
left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
select(author_name, institution, affiliation, degree,
title, publication_date, journal_title, citation_count) %>%
filter(!is.na(citation_count)) %>%
group_by(author_name, publication_date) %>%
summarise(total_citations = sum(citation_count, na.rm = T)) %>%
group_by(publication_date) %>%
summarise(gini_coefficient = reldist::gini(total_citations)) %>%
filter(publication_date > 1975) %>%
ggplot(aes(x = publication_date, y = gini_coefficient)) +
geom_line() +
scale_x_continuous(name = 'Year Published', breaks = seq(1975, 2020, by = 5)) +
scale_y_continuous(name = 'Citations Gini Index (among authors)',
breaks = seq(0, 0.5, by = 0.1), limits = c(0,0.5))
Journals_articles.data <- Articles.data %>%
filter(!is.na(citation_count) & !is.na(publication_date)) %>%
group_by(journal_title) %>%
summarise(mean_citations = round(mean(citation_count, na.rm = T)),
total_citations = sum(citation_count, na.rm = T),
total_articles = n()) %>%
arrange(-total_citations)
# create a citation count per economist per year and year since first publication
Author_citation_count.data <- Economists_articles.links %>%
left_join(select(Economists.data, url, name,
institution, affiliation, degree,) %>%
rename(author_name = name, author_url = url), by = 'author_url') %>%
left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
select(author_name, institution, affiliation, degree,
title, publication_date, journal_title, citation_count) %>%
filter(!is.na(citation_count)) %>%
group_by(author_name, publication_date) %>%
summarise(total_citations = sum(citation_count, na.rm = T)) %>%
arrange(author_name, publication_date) %>%
group_by(author_name) %>%
mutate(since_first = publication_date - first(publication_date))
# Add empty values for years since up to 40 if not listed in data (i.e. didn't publish in that year)
distinct_names <- Author_citation_count.data %>%
select(author_name) %>% distinct() %>% pull(author_name)
balanced_data <- matrix(ncol = 2, nrow = 41*length(distinct_names)) %>% data.frame()
colnames(balanced_data) <- c('author_name', 'since_first')
balanced_data$author_name <- distinct_names %>%
lapply(function(x) rep(x, 41)) %>% unlist()
balanced_data$since_first <- c(0:40) %>% rep(length(distinct_names))
## add on misisng values and a cumulative count of citatins
Author_cumulative_citations.data <- balanced_data %>%
left_join(Author_citation_count.data) %>%
group_by(author_name) %>%
replace_na(list(total_citations = 0)) %>%
mutate(publication_date = c(1:n()) - 1 + first(publication_date),
cum_citations = cumsum(total_citations)) %>%
filter(publication_date < 2020)
# SHow mean citations every year since first publication
Author_cumulative_citations.data %>%
group_by(since_first) %>%
summarise(mean_citations = mean(total_citations),
count = n()) %>%
mutate(cum_citations = cumsum(mean_citations)) %>%
ggplot(aes(x = since_first, y = mean_citations)) +
geom_point() +
scale_x_continuous(name = 'Year Since First Publication', breaks = seq(0, 40, by = 5)) +
scale_y_continuous(name = 'Cumulative Mean Citations',
breaks = seq(0, 800, by = 200), limits = c(0,800))
Author_cumulative_citations.data %>%
group_by(since_first) %>%
summarise(mean_citations = mean(total_citations),
count = n()) %>%
mutate(cum_citations = cumsum(mean_citations)) %>%
ggplot(aes(x = since_first, y = mean_citations)) +
geom_point() +
scale_x_continuous(name = 'Year Since First Publication', breaks = seq(0, 40, by = 5)) +
scale_y_continuous(name = 'Cumulative Mean Citations')
rm(list = ls())
gc()
gc()
