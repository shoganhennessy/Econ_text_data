---
title: "The Ideas.RePEc Listings of Articles in Economics"
author: "Senan Hogan-Hennessy, "
date: "`r format(Sys.time(), '%d %b %Y')`"
output: github_document
---
```{r setup, include=F}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, cache = F, fig.align = 'center')
library(tidyverse)
library(data.table)
library(tidytext)
library(fuzzyjoin) # https://github.com/dgrtwo/fuzzyjoin
```

## WORK IN PROGRESS -- to be finished soon.

The NBER series is a great source of research in our profession, but it isn't the full picture of research in the field.
It is, after all, a listing of working papers which are by definition not yet publications -- though most do go on to be published,
as I noted in the [last post.](https://github.com/shoganhennessy/Econ_text_data/blob/master/Blog_post_exploration/1_NBER_working_papers.md)

```{r, echo = F}
# Load the data on Economists
Economists.data <- fread('../Data/RePEc_data/Economists_data/Economists_repec_data.csv')
# Load the data on published articles
Articles.data <- fread('../Data/RePEc_data/Papers_data/Journal_articles_repec.csv')
# Load Economist-article individual links -- made externally in Python
Economists_articles.links <- fread('../Data/RePEc_data/Economists_data/Economists_articles_repec.csv')
```
Forunately, [Research Papers in Economics (RePEc)'s Ideas](https://ideas.repec.org/) provides a large listing of economics research which I can use as a complement to the NBER listings as it lists information on `r nrow(Economists.data)` economists and `r nrow(Articles.data)` published articles papers -- considering only those in English as of 9 January 2020.

> ''IDEAS is the largest bibliographic database dedicated to Economics and available freely on the Internet. 
> Based on RePEc, it indexes over 3,000,000 items of research, including over 2,700,000 that can be downloaded in full text.''
> 
> -- What is IDEAS?  [Ideas.RePEc.org/](https://ideas.repec.org/) 

`r nrow(Articles.data)` is a huge number of articles to consider, and comparable in size to articles that use the near complete set of publcations.<sup id="a1">[1](#f1)</sup>
RePEc has certain advantages: it is more open and it has a clear link to authors -- and importantly some of their characteristics -- to working and published papers, all within the field of economics.
It is however, a repository only within the economics sphere: citations are only counted among other papers in the database, and not among the universe of publications.

### Citations

For a sanity check, take a look at the most prolific authors in the field by citation count.<sup id="a1">[2](#f2)</sup>
```{r, echo=F}
# The most prolific authors, within these data
## WHo have the most citations, in these data
Economists_citations.data <- Economists_articles.links %>% 
  left_join(select(Economists.data, url, name, 
                   institution, affiliation, degree,) %>% 
              rename(author_name = name, author_url = url), by = 'author_url') %>%
  left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
  select(author_name, institution, affiliation, degree, 
         title, publication_date, journal_title, citation_count) %>%
  filter(!is.na(citation_count)) %>%
  group_by(author_name) %>%
  summarise(total_citations = sum(citation_count, na.rm = T),
            mean_citations = round(mean(citation_count, na.rm = T)),
            total_articles = n()) %>%
  arrange(-total_citations) 

# SHow the top ten 
Economists_citations.data %>% head(10) %>%
  knitr::kable(format = 'markdown')
```
There are some familiar faces among the names, which is to be expected! The process of assigning is, however, not perfect: citations are assigned from each article to each author equally when there are multiple authors.
Yet [Sarsons (2017)](https://www.aeaweb.org/articles?id=10.1257/aer.p20171126) shows how innapropriate this accounting is by exhibiting the unequal citation rate of return in among economists by gender -- which actually inspired me to work with economics publishing data in the first place!
Call it a point of interest to rank economists by better measures as this project progresses.


### Inequality in Publications

Draw a Gini coefficient for citations among articles.
```{r, echo=T}
# Gini coefficient for article citations.
Articles.data %>% 
  filter(!is.na(citation_count)) %>%
  pull(citation_count) %>% reldist::gini()
```


Histogram of citations for different periods
```{r, echo=T}
# Gini coefficient for article citations.
Articles.data %>% 
  filter(!is.na(citation_count)) %>%
  ggplot(aes(x = citation_count)) + 
  geom_histogram(binwidth = 1)

# Per year summarise 
Citation_count.data <- Articles.data %>% 
  filter(!is.na(citation_count) & !is.na(publication_date)) %>%
  group_by(publication_date) %>%
  summarise(total_citations = sum(citation_count, na.rm = T),
            mean_citations = round(mean(citation_count, na.rm = T)),
            total_articles = n(),
            gini_coefficient = reldist::gini(citation_count)) 

# Gini coefficient for article citations.
Citation_count.data %>%
  filter(total_articles	> 100) %>%
  ggplot(aes(x = publication_date, y = gini_coefficient)) +
  geom_line() +
  scale_x_continuous(name = 'Year Published', breaks = seq(1975, 2020, by = 5)) +
  scale_y_continuous(name = 'Citations Gini Index (among articles)',
                     breaks = seq(0, 0.5, by = 0.1), limits = c(0,0.5))
```

^ Draw a coefficient for the earlier period vs later period : larger field, more economists, but is it more top loaded now than before?  Perhaps less so now?



Draw a Gini coefficient for citations among authors per year.

Note: if going with the Gini index, then perhaps this should be collapsing a cumulative count of citations
per year among authors -- or at least consider that idea as collecting 'wealth' of citations.
```{r, echo=T}
# Gini coefficient for authors.
Economists_articles.links %>% 
  left_join(select(Economists.data, url, name, 
                   institution, affiliation, degree,) %>% 
              rename(author_name = name, author_url = url), by = 'author_url') %>%
  left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
  select(author_name, institution, affiliation, degree, 
         title, publication_date, journal_title, citation_count) %>%
  filter(!is.na(citation_count)) %>%
  group_by(author_name, publication_date) %>%
  summarise(total_citations = sum(citation_count, na.rm = T)) %>%
  group_by(publication_date) %>%
  summarise(gini_coefficient = reldist::gini(total_citations)) %>%
  filter(publication_date > 1975) %>%
  ggplot(aes(x = publication_date, y = gini_coefficient)) +
  geom_line() +
  scale_x_continuous(name = 'Year Published', breaks = seq(1975, 2020, by = 5)) +
  scale_y_continuous(name = 'Citations Gini Index (among authors)',
                     breaks = seq(0, 0.5, by = 0.1), limits = c(0,0.5))
  
```

Think about whether sharing of publications/work over the internet leads to more or less inequality -> perhaps a better question for the upcoming network analyses.


### The Top 5

Economists aim for the top 5 

CITE:
Top Five journals in economics: the American Economic Review, Econometrica,the Journal of Political Economy,the Quarterly Journal of Economics, and the Review of Economic Studies.
https://voxeu.org/article/publishing-and-promotion-economics-tyranny-top-five
https://www.nber.org/papers/w25093 

> Indeed, serious theoretical and empirical
> work should be conducted to understand this disease better and suggest possible treatments. The problem
> will probably require challenging techniques in applied mechanism design.
> 
> -- [Top5itis, R Serrano (2018)](http://hdl.handle.net/10419/202594)

-> measure citations from making a top 5, and follow on.
^Note that the graph or statistics on that LOOK like some causal identification of the effect, which is not the case
so be careful to not use causal language.

SHow how many articles in the top 10 (by simple citations count).
```{r, results='asis'}
Articles.data %>% 
  filter(!is.na(citation_count) & !is.na(publication_date)) %>%
  group_by(journal_title) %>%
  summarise(mean_citations = round(mean(citation_count, na.rm = T)),
            total_citations = sum(citation_count, na.rm = T),
            total_articles = n()) %>%
  arrange(-total_citations) %>% head(10) %>% 
  knitr::kable(format = 'markdown')
```


Draw a line graph for author cumulative citations, years after first publication.
NOTE: attributing citations to year of publication and not year in which a reader cites the previous work in a new publication (which I will consider later in network effects).
```{r, results='asis'}
# create a citation count per economist per year and year since first publication
Author_citation_count.data <- Economists_articles.links %>% 
  left_join(select(Economists.data, url, name, 
                   institution, affiliation, degree,) %>% 
              rename(author_name = name, author_url = url), by = 'author_url') %>%
  left_join(rename(Articles.data, article_url = url), by = 'article_url') %>%
  select(author_name, institution, affiliation, degree, 
         title, publication_date, journal_title, citation_count) %>%
  filter(!is.na(citation_count)) %>%
  group_by(author_name, publication_date) %>%
  summarise(total_citations = sum(citation_count, na.rm = T)) %>%
  arrange(author_name, publication_date) %>%
  group_by(author_name) %>%
  mutate(since_first = publication_date - first(publication_date))

# Add empty values for years since up to 40 if not listed in data (i.e. didn't publish in that year)
distinct_names <- Author_citation_count.data %>% 
  select(author_name) %>% distinct() %>% pull(author_name)

balanced_data <- matrix(ncol = 2, nrow = 41*length(distinct_names)) %>% data.frame()
colnames(balanced_data) <- c('author_name', 'since_first')

balanced_data$author_name <- distinct_names %>% 
  lapply(function(x) rep(x, 41)) %>% unlist()
balanced_data$since_first <- c(0:40) %>% rep(length(distinct_names))

## add on misisng values and a cumulative count of citatins
Author_cumulative_citations.data <- balanced_data %>% 
  left_join(Author_citation_count.data) %>%
  group_by(author_name) %>%
  replace_na(list(total_citations = 0)) %>%
  mutate(publication_date = c(1:n()) - 1 + first(publication_date),
         cum_citations = cumsum(total_citations)) %>%
  filter(publication_date < 2020) 

# SHow mean citations every year since first publication
Author_cumulative_citations.data %>%
  group_by(since_first) %>%
  summarise(mean_citations = mean(total_citations),
            count = n()) %>%
  mutate(cum_citations = cumsum(mean_citations)) %>%
  ggplot(aes(x = since_first, y = cum_citations)) +
  geom_point() +
  scale_x_continuous(name = 'Year Since First Publication', breaks = seq(0, 40, by = 5)) +
  scale_y_continuous(name = 'Cumulative Mean Citations',
                     breaks = seq(0, 800, by = 200), limits = c(0,800))
```


^ Test the correlation for an article in top 10 making a career.

^ Compare to people who make 6-10 : weakly comparable, perhaps, so note the thoughts.
```{r, results='asis'}

```


### Link to the NBER

Draw maps of where they're from
and test a correlation: distance to publication home institution and economist base.
^ Start of testing locality or inclusion.

Further opportunity link to NBER working paper and measure change from WP to published article

**Next up:** Looking at inclusion in the *NBER family*.

***
<b id="f1">1</b> [Angrist et al. (2017)](https://www.nber.org/papers/w23698) link Econlit and Web of Science for similar coverage, for example.[↩](#a1)

<b id="f2">2</b> Again, note that this citation count is not the same as that in the universe of academic publications or Google Scholar, it is a count of the citations within the RePEc listings so a measure of citations within only this large coverage of the field.[↩](#a1)
